1. calculate_deviations_from_axis(coordinates_3d, axis_results)

    Рассчитывает отклонения частиц от оси во времени

    Для каждого временного шага и каждой частицы:

        Вычисляет проекцию на ось (параметр t)

        Вычисляет вектор отклонения от оси

        Рассчитывает евклидово расстояние до оси

    Возвращает:

        max_axis_deviations: максимальные отклонения для каждой частицы

        mean_axis_deviations: средние отклонения для каждой частицы

        Отклонения по осям X, Y, Z отдельно

        Статистику проекций на ось

2. save_axis_deviations_to_csv() - создает 3 CSV файла:

    axis_deviations.csv - подробный файл с:

        Параметры оси структуры

        Общая статистика отклонений

        Данные по каждой частице:

            Медианные положения

            Параметр t (положение вдоль оси)

            Максимальные и средние отклонения от оси

            Отклонения по осям X, Y, Z

            Расстояние медианы до оси

            Относительные отклонения (%)

        Топ-10 частиц с наибольшими отклонениями

    axis_deviations_simple.csv - упрощенная таблица:

        Только основные параметры

        Формат, удобный для дальнейшего анализа

    axis_statistics_summary.csv - сводная статистика:

        Ключевые статистические показатели

        Удобно для быстрого ознакомления

3. plot_axis_deviations() - создает графики:

    Гистограмма максимальных отклонений от оси

    Точечные графики отклонений по частицам

    Графики отклонений по координатам X, Y, Z

    Графики трендов зависимости отклонений от положения вдоль оси

Структура основного CSV файла (axis_deviations.csv):
Разделы:

    Параметры оси структуры - уравнение, центр масс, направление, R²

    Общая статистика отклонений - средние, максимальные, минимальные значения

    Статистика по осям координат - вклад каждой оси в отклонения

    Данные по каждой частице (18 параметров на частицу):

        ID частицы

        Медианные координаты X, Y, Z

        Параметр t и его стандартное отклонение

        Максимальные, средние и стандартные отклонения от оси

        Максимальные и средние отклонения по осям X, Y, Z

        Расстояние медианы до оси

        Относительное отклонение (%)

    Топ-10 частиц с наибольшими отклонениями

Ключевые показатели в CSV:

    Макс. откл. от оси - максимальное отклонение частицы от оси за все время

    Ср. откл. от оси - среднее отклонение частицы от оси

    Параметр t - положение частицы вдоль оси (среднее)

    Расст. медианы до оси - расстояние медианного положения до оси

    Относ. откл. (%) - относительное отклонение в % от среднего
