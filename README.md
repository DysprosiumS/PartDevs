Модуль межчастичных расстояний
----------------------------------------------------

1. calculate_deviations_from_axis(coordinates_3d, axis_results)

    Рассчитывает отклонения частиц от оси во времени

    Для каждого временного шага и каждой частицы:

        Вычисляет проекцию на ось (параметр t)

        Вычисляет вектор отклонения от оси

        Рассчитывает евклидово расстояние до оси

    Возвращает:

        max_axis_deviations: максимальные отклонения для каждой частицы

        mean_axis_deviations: средние отклонения для каждой частицы

        Отклонения по осям X, Y, Z отдельно

        Статистику проекций на ось

2. save_axis_deviations_to_csv() - создает 3 CSV файла:

    axis_deviations.csv - подробный файл с:

        Параметры оси структуры

        Общая статистика отклонений

        Данные по каждой частице:

            Медианные положения

            Параметр t (положение вдоль оси)

            Максимальные и средние отклонения от оси

            Отклонения по осям X, Y, Z

            Расстояние медианы до оси

            Относительные отклонения (%)

        Топ-10 частиц с наибольшими отклонениями

    axis_deviations_simple.csv - упрощенная таблица:

        Только основные параметры

        Формат, удобный для дальнейшего анализа

    axis_statistics_summary.csv - сводная статистика:

        Ключевые статистические показатели

        Удобно для быстрого ознакомления

3. plot_axis_deviations() - создает графики:

    Гистограмма максимальных отклонений от оси

    Точечные графики отклонений по частицам

    Графики отклонений по координатам X, Y, Z

    Графики трендов зависимости отклонений от положения вдоль оси

Структура основного CSV файла (axis_deviations.csv):
Разделы:

    Параметры оси структуры - уравнение, центр масс, направление, R²

    Общая статистика отклонений - средние, максимальные, минимальные значения

    Статистика по осям координат - вклад каждой оси в отклонения

    Данные по каждой частице (18 параметров на частицу):

        ID частицы

        Медианные координаты X, Y, Z

        Параметр t и его стандартное отклонение

        Максимальные, средние и стандартные отклонения от оси

        Максимальные и средние отклонения по осям X, Y, Z

        Расстояние медианы до оси

        Относительное отклонение (%)

    Топ-10 частиц с наибольшими отклонениями

Ключевые показатели в CSV:

    Макс. откл. от оси - максимальное отклонение частицы от оси за все время

    Ср. откл. от оси - среднее отклонение частицы от оси

    Параметр t - положение частицы вдоль оси (среднее)

    Расст. медианы до оси - расстояние медианного положения до оси

Модуль расстояний до медианы и оси
----------------------------------------------------

1. Все расчеты теперь в микрометрах:

    Координаты масштабируются при чтении: x_data * SCALE

    Все статистики выводятся в микрометрах

    Графики подписаны с указанием единиц "(мкм)"

2. Обновленные функции:
calculate_median_deviations():

    Рассчитывает отклонения от медианных положений частиц

    Возвращает максимальные, средние и стандартные отклонения

    Все значения в микрометрах

calculate_axis_line():

    Рассчитывает ось структуры методом PCA

    Возвращает уравнение оси, центр масс, направляющий вектор

    Рассчитывает расстояния от медиан до оси

    Все значения в микрометрах

calculate_deviations_from_axis():

    Рассчитывает отклонения частиц от оси во времени

    Возвращает статистику по каждому моменту времени

    Все значения в микрометрах

3. Новые CSV файлы (в микрометрах):

    deviations_analysis_microns.csv - основной файл:

        Параметры оси структуры

        Общая статистика отклонений

        Данные по каждой частице (25 параметров)

    axis_deviations_stats_microns.csv - отклонения от оси:

        Максимальные, средние, стандартные отклонения

        Отклонения по осям X, Y, Z

        Проекции на ось (параметр t)

    median_deviations_stats_microns.csv - отклонения от медиан:

        Отклонения от собственных медианных положений

        По осям X, Y, Z отдельно

    deviations_comparison_microns.csv - сравнение отклонений:

        Разница между отклонениями от оси и от медиан

        Относительные разницы в процентах

        Коэффициенты стабильности

    deviations_overall_stats_microns.csv - общая статистика:

        Ключевые показатели

        Отношения отклонений

        Качество аппроксимации

4. Графики (в микрометрах):

    Сравнение отклонений:

        Максимальные отклонения от оси vs от медиан

        Средние отклонения от оси vs от медиан

        Гистограммы распределений

    Детальные графики:

        Отклонения по осям X, Y, Z

        Зависимость от положения на оси

        Boxplot всех типов отклонений

    3D график оси:

        Медианные положения частиц

        Ось структуры

        Центр масс и направляющий вектор

5. Ключевые показатели:
Для каждой частицы:

    Макс. откл. от оси - максимальное отклонение от оси (мкм)

    Ср. откл. от оси - среднее отклонение от оси (мкм)

    Макс. откл. от медианы - максимальное отклонение от собственной медианы (мкм)

    Параметр t - положение на оси (мкм)

    Расст. медианы до оси - расстояние медианного положения до оси (мкм)

Общая статистика:

    Качество аппроксимации R² - насколько хорошо ось описывает структуру (0-1)

    Отношение отклонений = отклонения от оси / отклонения от медиан

    Среднее расстояние до оси - насколько частицы удалены от оси (мкм)

    Относ. откл. (%) - относительное отклонение в % от среднего
